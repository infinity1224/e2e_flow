```mermaid
graph TD
    A[Developer Pushes Code to GitHub] -->|Webhook| B{Jenkins CI Pipeline}
    B --> C[Terraform Init & Select Workspace: Dev/QA/Prod]
    C --> D[Terraform Plan with S3 Backend]
    D -->|PR Approval for Prod| E[Terraform Apply: Provision KOPS Cluster & Namespaces]
    E --> F[Pull Code]
    F --> G[SonarQube Scan]
    G -->|Pass Quality Gates| H[Maven Build: mvn clean package]
    H --> I[Create Docker Image]
    I --> J[Trivy Scan]
    J -->|No Critical Issues| K[Push Image to Docker Hub]
    K --> L[CI Pipeline Ends]

    L --> M[Update Manifests in GitHub Repo]
    M --> N{ArgoCD Monitors Manifests Repo}

    subgraph Dev Environment
        N -->|Dev Manifest| O[ArgoCD Deploys to Dev Namespace]
        O --> P[Automated Tests]
        P --> Q[Monitor with Prometheus & Grafana]
    end

    subgraph QA Environment
        Q -->|Dev Validated| R[Update QA Manifest + PR]
        R --> S[ArgoCD Deploys to QA Namespace]
        S --> T[Integration Tests]
        T --> U[Monitor with Prometheus & Grafana]
    end

    subgraph Prod Environment
        U -->|QA Validated| V[Update Prod-Green Manifest + PR]
        V --> W[ArgoCD Deploys to Prod-Green Namespace]
        W --> X[Run Tests in Prod-Green]
        X --> Y[Monitor with Prometheus & Grafana]
        Y -->|Validated| Z[Update Ingress to Switch Traffic to Prod-Green]
        Z --> AA[Prod-Green Live]
        AA --> AB[Monitor with Prometheus & Grafana]
        AB -->|Issues Detected| AC[Revert Ingress to Prod-Blue]
        AA --> AD[Update Prod-Blue for Next Release]
        W --> AE[Prod-Blue Remains Active as Fallback]
    end

    subgraph AWS Infrastructure
        E --> AF[KOPS Kubernetes Cluster]
        O --> AF
        S --> AF
        W --> AF
        AE --> AF
        AF --> AG[AWS ALB for Traffic Routing]
        AG --> AH[Prod-Blue Service]
        AG --> AI[Prod-Green Service]
        AF --> AJ[Metrics Server]
        AJ --> AK[Prometheus]
        AK --> AL[Grafana]
        AF --> AM[S3 Backend for Terraform State]
        AM --> AN[DynamoDB for State Locking]
    end
```
